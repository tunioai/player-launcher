# Tunio Radio Player

Приложение Flutter для Android, которое автоматически воспроизводит онлайн радио поток с поддержкой автозагрузки и устойчивости к разрывам сети.

## Возможности

- **Автозагрузка**: Приложение автоматически запускается при загрузке устройства
- **API интеграция**: Подключение к Tunio API для получения конфигурации потока
- **Устойчивое воспроизведение**: Автоматическое переподключение при разрыве сети
- **Буферизация**: Оптимизированная буферизация для непрерывного воспроизведения
- **Управление громкостью**: Локальное и удаленное управление громкостью
- **Локальное хранилище**: Сохранение API ключа для автоматического подключения

## Установка

### Предварительные требования

- Flutter SDK (версия 3.4.3 или выше)
- Android SDK
- Android устройство или эмулятор (API level 21+)

### Сборка приложения

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd tunio_radio_player
```

2. Установите зависимости:
```bash
flutter pub get
```

3. Соберите APK:
```bash
flutter build apk --release
```

4. Установите на устройство:
```bash
flutter install
```

## Использование

### Первичная настройка

1. Запустите приложение
2. Введите ваш Tunio API ключ в поле "API Key"
3. Нажмите кнопку "Connect"
4. Приложение автоматически начнет воспроизведение при успешном подключении

### Управление воспроизведением

- **Play/Pause**: Используйте центральную кнопку для управления воспроизведением
- **Громкость**: Регулируйте громкость с помощью слайдера
- **Статус**: Мониторьте состояние подключения и воспроизведения

### Автозагрузка

После сохранения API ключа приложение будет:
- Автоматически запускаться при загрузке устройства
- Подключаться к API и начинать воспроизведение
- Работать в фоновом режиме

## API интеграция

Приложение использует Tunio API для получения конфигурации потока:

```
GET https://api.tunio.ai/stream/config?token=YOUR_API_KEY
```

Ожидаемый ответ:
```json
{
  "stream_url": "http://stream.example.com:8000/stream",
  "volume": 0.8,
  "title": "Radio Station Name",
  "description": "Station description"
}
```

## Технические детали

### Архитектура

- **Модели**: `StreamConfig` для конфигурации потока
- **Сервисы**: 
  - `ApiService` - работа с API
  - `AudioService` - воспроизведение аудио
  - `StorageService` - локальное хранилище
- **Контроллеры**: `RadioController` - основная логика приложения
- **UI**: `HomeScreen` - главный экран приложения

### Основные зависимости

- `just_audio` - аудио воспроизведение
- `shared_preferences` - локальное хранилище
- `http` - сетевые запросы
- `connectivity_plus` - мониторинг сети
- `audio_session` - управление аудио сессией

### Устойчивость к сбоям

- Автоматическое переподключение при потере сети
- Максимум 10 попыток переподключения с интервалом 5 секунд
- Буферизация для сглаживания временных перебоев
- Обработка различных типов ошибок сети

### Разрешения Android

Приложение требует следующие разрешения:
- `INTERNET` - доступ к интернету
- `ACCESS_NETWORK_STATE` - мониторинг состояния сети
- `RECEIVE_BOOT_COMPLETED` - автозагрузка
- `WAKE_LOCK` - предотвращение перехода в спящий режим
- `FOREGROUND_SERVICE` - фоновое воспроизведение

## Разработка

### Структура проекта

```
lib/
├── models/
│   └── stream_config.dart          # Модель конфигурации потока
├── services/
│   ├── api_service.dart           # Сервис для работы с API
│   ├── audio_service.dart         # Сервис аудио воспроизведения
│   └── storage_service.dart       # Сервис локального хранилища
├── controllers/
│   └── radio_controller.dart      # Основной контроллер приложения
├── screens/
│   └── home_screen.dart           # Главный экран
└── main.dart                      # Точка входа приложения
```

### Добавление новых функций

1. Добавьте новые модели в папку `models/`
2. Расширьте существующие сервисы или создайте новые в `services/`
3. Обновите контроллер для интеграции новой логики
4. Модифицируйте UI в соответствии с новыми возможностями

## Устранение неполадок

### Проблемы с автозагрузкой

1. Убедитесь, что приложение имеет разрешение на автозапуск в настройках Android
2. Проверьте, что API ключ сохранен корректно
3. В некоторых версиях Android может потребоваться отключение оптимизации батареи

### Проблемы с воспроизведением

1. Проверьте интернет-соединение
2. Убедитесь в корректности API ключа
3. Проверьте доступность потокового URL
4. Убедитесь, что приложение имеет аудио разрешения

### Проблемы с сетью

- Приложение автоматически переподключается при восстановлении сети
- При длительных перебоях может потребоваться ручное переподключение
- Проверьте настройки брандмауэра и прокси

## Лицензия

[Укажите лицензию вашего проекта]

## Поддержка

Для получения поддержки обращайтесь к разработчикам или создавайте issue в репозитории проекта.
