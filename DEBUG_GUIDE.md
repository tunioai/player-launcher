# Tunio Radio App - Debug Guide

## –ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è "Loading..."

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "Loading...", –µ—Å—Ç—å –ø–∏–Ω–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 76ms), WiFi —Ä–∞–±–æ—Ç–∞–µ—Ç ("OK"), –Ω–æ –±—É—Ñ–µ—Ä = 0 –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è.

## –ù–æ–≤—ã–µ –¥–µ–±–∞–≥-–ª–æ–≥–∏

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:

- `üîÑ API_DEBUG` - API –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã
- `üéµ AUDIO_DEBUG` - –ê—É–¥–∏–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
- `üéµ STATE_DEBUG` - –°–º–µ–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∞—É–¥–∏–æ –ø–ª–µ–µ—Ä–∞
- `üìä BUFFER_DEBUG` - –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- `üåê NET_DEBUG` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `üåê PING_DEBUG` - –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–∏–Ω–≥–∞
- `üéõÔ∏è CONTROLLER_DEBUG` - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ä–∞–¥–∏–æ
- `üîó ATTEMPT_DEBUG` - –ü–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `üîÑ RECONNECT_DEBUG` - –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `üéõÔ∏è TIMEOUT_DEBUG` - –¢–∞–π–º–∞—É—Ç—ã
- `üéõÔ∏è HEALTH_DEBUG` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å—Ç—Ä–∏–º–∞
- `ü©∫ DIAGNOSTIC_*` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä—ã–π —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
./debug_logs.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø –ª–æ–≥–æ–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:
- –í–∞—Ä–∏–∞–Ω—Ç 8 - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –í–∞—Ä–∏–∞–Ω—Ç 0 - –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ –∏ –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º—ã–µ –∫–æ–º–∞–Ω–¥—ã adb

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–µ–±–∞–≥ –ª–æ–≥–∏
adb logcat -s "flutter" | grep -E "(API_DEBUG|AUDIO_DEBUG|NET_DEBUG|CONTROLLER_DEBUG|BUFFER_DEBUG|STATE_DEBUG|PING_DEBUG|ATTEMPT_DEBUG|TIMEOUT_DEBUG|RECONNECT_DEBUG|DIAGNOSTIC_|HEALTH_DEBUG)"

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
adb logcat -s "flutter" | grep -E "(ERROR|CRITICAL|ZERO BUFFER|Stream stuck|Timeout|Failed)"

# –¢–æ–ª—å–∫–æ –±—É—Ñ–µ—Ä (–¥–ª—è –ø—Ä–æ–±–ª–µ–º—ã –±—É—Ñ–µ—Ä = 0)
adb logcat -s "flutter" | grep "BUFFER_DEBUG"
```

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–≤–∏—Å–∞–Ω–∏—è

### –®–∞–≥ 1: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤:
   ```bash
   ./debug_logs.sh
   # –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç 8 (live monitoring)
   ```

2. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ—è–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ "Loading..." —Å –∑–∞–≤–∏—Å–∞–Ω–∏–µ–º

### –®–∞–≥ 2: –ö–ª—é—á–µ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

–ò—â–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:

#### –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```
üîÑ API_DEBUG: Starting API request...
üîÑ API_DEBUG: HTTP request completed in Xms
üéµ AUDIO_DEBUG: About to set audio source...
üéµ STATE_DEBUG: LOADING state detected
üéµ STATE_DEBUG: PLAYING state detected
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å API:
```
üîÑ API_DEBUG: Timeout exception during API call
üîÑ API_DEBUG: HTTP client exception
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å –∞—É–¥–∏–æ:
```
üéµ AUDIO_DEBUG: Error in playStream
üéµ STATE_DEBUG: Stream stuck in LOADING
üö® BUFFER_DEBUG: ZERO BUFFER detected!
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é:
```
üåê NET_DEBUG: Connectivity check failed
üåê PING_DEBUG: HIGH PING detected
```

### –®–∞–≥ 3: –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–∞–º–ø

–ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

```
ü©∫ DIAGNOSTIC_HEALTH_CHECK: === SYSTEM STATE DUMP ===
ü©∫ DIAGNOSTIC_HEALTH_CHECK: Audio State: AudioState.loading
ü©∫ DIAGNOSTIC_HEALTH_CHECK: Network State: CONNECTED
ü©∫ DIAGNOSTIC_HEALTH_CHECK: Buffer: 0s
```

### –®–∞–≥ 4: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ø—Ä–æ–±–ª–µ–º—ã:

```
üéõÔ∏è HEALTH_DEBUG: Stream stuck in AudioState.loading for over 2 minutes!
üéõÔ∏è HEALTH_DEBUG: This is likely the hanging issue we are debugging
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–±–ª–µ–º

### 1. –ë—É—Ñ–µ—Ä = 0 –∏ –∑–∞–≤–∏—Å–∞–Ω–∏–µ
```
üö® BUFFER_DEBUG: ZERO BUFFER detected!
üéµ STATE_DEBUG: LOADING state detected - stream is connecting
```
**–ü—Ä–∏—á–∏–Ω–∞**: –ê—É–¥–∏–æ –ø–ª–µ–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–æ —Å—Ç—Ä–∏–º–∞

### 2. API —É—Å–ø–µ—à–µ–Ω, –Ω–æ –∞—É–¥–∏–æ –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç
```
üîÑ API_DEBUG: API call completed successfully
üéµ AUDIO_DEBUG: Error in playStream: [error details]
```
**–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–æ–º –∏–ª–∏ –µ–≥–æ —Ñ–æ—Ä–º–∞—Ç–æ–º

### 3. –°–µ—Ç—å OK, –Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
```
üåê NET_DEBUG: Connectivity result: true
üåê PING_DEBUG: Ping measurement: 76ms
üö® BUFFER_DEBUG: ZERO BUFFER detected!
```
**–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞—É–¥–∏–æ —Å–µ—Ä–≤–µ—Ä–æ–º –∏–ª–∏ URL

## –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –±–∞–≥—Ä–µ–ø–æ—Ä—Ç–∞

–ö–æ–≥–¥–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏:

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª
adb logcat -s "flutter" > debug_full.log

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è
adb logcat -s "flutter" | grep -E "(ERROR|CRITICAL|ZERO BUFFER|Stream stuck)" > debug_critical.log
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º
adb logcat -c

# –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
adb logcat -s "flutter" -t 100

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∏–Ω—É—Ç)
adb logcat -s "flutter" -t '10 minutes ago'
```

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–∏—Å–ª–æ –≤ "Loading...":

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `./debug_logs.sh` (–≤—ã–±–æ—Ä 9 - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏)
2. –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å `ZERO BUFFER` –∏–ª–∏ `Stream stuck`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ `API_DEBUG` –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `NET_DEBUG` –¥–ª—è –ø—Ä–æ–±–ª–µ–º —Å —Å–µ—Ç—å—é

–≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É –∑–∞–≤–∏—Å–∞–Ω–∏—è. 